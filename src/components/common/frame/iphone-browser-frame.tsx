import { forwardRef, PropsWithChildren, useMemo } from 'react'

// NOTE 428 x 926 の画面を埋め込む

type IphoneBrowserFrameProps = {
  innerWidth?: number
}

const defaultInnerWidth = 428
// const defaultInnerHeight = 840
const defaultWidth = 428
const defaultHeight = 926
const defaultStatusBarHeight = 38
const defaultBottomBarHeight = 48

export const IphoneBrowserFrame = forwardRef<
  SVGSVGElement,
  PropsWithChildren<IphoneBrowserFrameProps>
>(function IphoneFrame({ children, innerWidth = 428, ...props }, ref) {
  const { width, height, viewBox, statusBarHeight, bottomBarHeight } =
    useMemo(() => {
      const scale = innerWidth / defaultInnerWidth
      const width = defaultWidth * scale
      const height = defaultHeight * scale

      const statusBarHeight = defaultStatusBarHeight * scale
      const bottomBarHeight = defaultBottomBarHeight * scale

      return {
        width: `${width}`,
        height: `${height}`,
        viewBox: `0 0 ${width} ${height}`,
        statusBarHeight,
        bottomBarHeight,
      }
    }, [innerWidth])

  return (
    <div className="shadow-2xl w-fit h-fit">
      <div className="relative w-fit h-fit overflow-hidden">
        <svg
          width={width}
          height={height}
          viewBox={viewBox}
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          ref={ref}
          {...props}
        >
          <g clip-path="url(#clip0_68_660)">
            <rect width="428" height="926" fill="#F7F7F7" />
            <g filter="url(#filter0_d_68_660)">
              <rect
                y="878"
                width="428"
                height="50"
                fill="#F7F6F6"
                fill-opacity="0.74"
              />
            </g>
            <path
              d="M187.077 902.5H191.352C191.931 902.5 192.214 902.205 192.214 901.559V898.173C192.214 897.592 191.981 897.292 191.5 897.241V896.079C191.5 894.34 190.391 893.5 189.214 893.5C188.038 893.5 186.928 894.34 186.928 896.079V897.264C186.488 897.333 186.214 897.629 186.214 898.173V901.559C186.214 902.205 186.497 902.5 187.077 902.5ZM187.651 895.982C187.651 894.824 188.375 894.21 189.214 894.21C190.054 894.21 190.777 894.824 190.777 895.982V897.237L187.651 897.241V895.982Z"
              fill="#676769"
            />
            <path
              d="M201.259 904.623H200.127C200.191 904.121 200.217 903.71 200.217 903.183V896.471C200.217 895.854 200.191 895.481 200.127 894.993H201.156V895.726C201.156 895.893 201.143 896.034 201.117 896.253C201.696 895.34 202.596 894.864 203.74 894.864C205.72 894.864 206.929 896.214 206.929 898.451C206.929 900.637 205.694 902.039 203.766 902.039C202.634 902.039 201.721 901.563 201.117 900.676C201.156 901.036 201.169 901.229 201.169 901.576V903.17C201.169 903.774 201.194 904.147 201.259 904.623ZM203.676 901.203C205.077 901.203 205.926 900.161 205.926 898.451C205.926 896.703 205.103 895.7 203.663 895.7C202.184 895.7 201.181 896.806 201.181 898.464C201.181 899.3 201.451 900.071 201.914 900.521C202.364 900.959 203.007 901.203 203.676 901.203ZM209.596 901.923H208.452C208.516 901.46 208.542 901.113 208.542 900.47V893.604C208.542 892.961 208.516 892.627 208.452 892.151H209.596C209.519 892.627 209.493 892.961 209.493 893.617V895.79C209.493 895.996 209.493 896.099 209.455 896.433C209.712 896.009 209.853 895.816 210.162 895.559C210.715 895.083 211.306 894.864 212.09 894.864C213.595 894.864 214.495 895.751 214.495 897.256V900.483C214.495 901.074 214.52 901.447 214.585 901.923H213.427C213.492 901.499 213.517 901.113 213.517 900.47V897.436C213.517 896.317 212.965 895.713 211.962 895.713C211.242 895.713 210.65 896.021 210.149 896.651C209.789 897.114 209.622 897.461 209.506 898.001V900.47C209.506 901.036 209.532 901.421 209.596 901.923ZM220.836 894.993L220.553 895.983C220.064 895.829 219.833 895.79 219.511 895.79C218.856 895.79 218.316 896.06 217.93 896.574C217.621 896.973 217.506 897.281 217.454 897.86V900.483C217.454 901.061 217.48 901.421 217.544 901.923H216.387C216.451 901.331 216.477 900.997 216.477 900.47V896.446C216.477 895.803 216.451 895.456 216.387 894.993H217.454V895.726C217.454 895.829 217.454 896.021 217.441 896.111C217.686 895.713 217.878 895.507 218.148 895.327C218.637 895.006 219.074 894.877 219.691 894.877C220.077 894.877 220.296 894.903 220.836 894.993ZM226.489 901.923V901.01C225.987 901.46 225.743 901.627 225.306 901.794C224.869 901.961 224.406 902.051 223.969 902.051C222.554 902.051 221.693 901.319 221.693 900.097C221.693 899.069 222.336 898.323 223.532 897.989C224.29 897.77 224.907 897.693 226.489 897.654V896.909C226.489 896.034 225.936 895.584 224.869 895.584C224.162 895.584 223.634 895.764 223.274 896.137C223.107 896.317 223.004 896.497 222.876 896.883L221.873 896.664C222.104 896.073 222.272 895.803 222.593 895.52C223.12 895.031 223.892 894.787 224.856 894.787C226.553 894.787 227.427 895.507 227.427 896.896V900.509C227.427 901.087 227.453 901.409 227.53 901.923H226.489ZM226.489 899.249V898.413C224.959 898.451 224.226 898.541 223.647 898.786C222.992 899.056 222.67 899.493 222.67 900.11C222.67 900.817 223.197 901.267 224.033 901.267C224.779 901.267 225.589 900.907 226.09 900.354C226.386 900.033 226.489 899.763 226.489 899.249ZM234.141 894.954V895.726C233.82 896.073 233.601 896.343 233.28 896.78L230.515 900.47C230.49 900.496 230.297 900.74 230.027 901.074C230.657 901.049 230.695 901.049 230.914 901.049H232.945C233.614 901.049 233.974 901.023 234.398 900.959V902.013C233.935 901.949 233.601 901.923 232.945 901.923H230.22C229.423 901.923 229.153 901.936 228.793 901.961V901.113C229.075 900.817 229.333 900.521 229.667 900.071L232.495 896.291C232.637 896.099 232.727 895.996 232.881 895.829C232.534 895.854 232.418 895.854 232.238 895.854H230.49C229.95 895.854 229.538 895.88 229.05 895.944V894.903C229.551 894.967 229.924 894.993 230.49 894.993H232.778C233.575 894.993 233.781 894.993 234.141 894.954ZM241.779 898.606H236.366C236.405 899.467 236.533 899.943 236.88 900.406C237.292 900.971 237.922 901.28 238.693 901.28C239.735 901.28 240.455 900.766 240.815 899.776L241.715 900.136C241.47 900.676 241.303 900.907 241.008 901.203C240.403 901.794 239.619 902.103 238.68 902.103C236.662 902.103 235.389 900.689 235.389 898.464C235.389 896.266 236.649 894.826 238.578 894.826C240.236 894.826 241.432 895.893 241.689 897.616C241.702 897.757 241.753 898.259 241.779 898.606ZM236.405 897.796H240.75C240.673 897.076 240.48 896.613 240.069 896.214C239.67 895.829 239.169 895.636 238.552 895.636C237.768 895.636 237.112 896.034 236.726 896.754C236.546 897.076 236.482 897.307 236.405 897.796Z"
              fill="#202124"
            />
            <path
              opacity="0.35"
              d="M391.667 17.8334H408.333C409.53 17.8334 410.5 18.8034 410.5 20V26C410.5 27.1967 409.53 28.1667 408.333 28.1667H391.667C390.47 28.1667 389.5 27.1967 389.5 26V20C389.5 18.8034 390.47 17.8334 391.667 17.8334Z"
              stroke="black"
            />
            <path
              opacity="0.4"
              d="M412 21V25C412.805 24.6613 413.328 23.8732 413.328 23C413.328 22.1269 412.805 21.3388 412 21"
              fill="black"
            />
            <path
              d="M391 20.6667C391 19.9303 391.597 19.3334 392.333 19.3334H407.667C408.403 19.3334 409 19.9303 409 20.6667V25.3334C409 26.0698 408.403 26.6667 407.667 26.6667H392.333C391.597 26.6667 391 26.0698 391 25.3334V20.6667Z"
              fill="black"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M376.33 19.608C378.546 19.6081 380.677 20.4596 382.283 21.9863C382.404 22.1042 382.597 22.1027 382.716 21.983L383.872 20.8163C383.933 20.7556 383.966 20.6734 383.966 20.5878C383.965 20.5022 383.931 20.4204 383.87 20.3603C379.655 16.3208 373.005 16.3208 368.79 20.3603C368.729 20.4203 368.694 20.5021 368.693 20.5877C368.693 20.6733 368.726 20.7556 368.787 20.8163L369.943 21.983C370.062 22.1029 370.255 22.1044 370.376 21.9863C371.982 20.4595 374.114 19.608 376.33 19.608ZM376.33 23.4037C377.547 23.4036 378.721 23.8561 379.624 24.6733C379.746 24.7893 379.938 24.7868 380.057 24.6677L381.212 23.501C381.273 23.4398 381.306 23.3568 381.306 23.2705C381.305 23.1843 381.269 23.102 381.207 23.042C378.459 20.4856 374.203 20.4856 371.455 23.042C371.393 23.102 371.357 23.1843 371.357 23.2706C371.356 23.3569 371.39 23.4399 371.451 23.501L372.605 24.6677C372.724 24.7868 372.916 24.7893 373.038 24.6733C373.94 23.8567 375.113 23.4042 376.33 23.4037ZM378.643 25.9575C378.645 26.044 378.611 26.1274 378.549 26.188L376.552 28.2037C376.493 28.2629 376.413 28.2963 376.33 28.2963C376.247 28.2963 376.167 28.2629 376.108 28.2037L374.111 26.188C374.049 26.1274 374.015 26.0439 374.017 25.9574C374.019 25.8709 374.056 25.789 374.12 25.731C375.396 24.6521 377.264 24.6521 378.54 25.731C378.604 25.789 378.641 25.871 378.643 25.9575Z"
              fill="black"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M362.667 17.6666H361.667C361.114 17.6666 360.667 18.1143 360.667 18.6666V27.3333C360.667 27.8856 361.114 28.3333 361.667 28.3333H362.667C363.219 28.3333 363.667 27.8856 363.667 27.3333V18.6666C363.667 18.1143 363.219 17.6666 362.667 17.6666ZM357 20H358C358.552 20 359 20.4477 359 21V27.3333C359 27.8856 358.552 28.3333 358 28.3333H357C356.448 28.3333 356 27.8856 356 27.3333V21C356 20.4477 356.448 20 357 20ZM353.333 22.3333H352.333C351.781 22.3333 351.333 22.781 351.333 23.3333V27.3333C351.333 27.8856 351.781 28.3333 352.333 28.3333H353.333C353.885 28.3333 354.333 27.8856 354.333 27.3333V23.3333C354.333 22.781 353.885 22.3333 353.333 22.3333ZM348.667 24.3333H347.667C347.114 24.3333 346.667 24.781 346.667 25.3333V27.3333C346.667 27.8856 347.114 28.3333 347.667 28.3333H348.667C349.219 28.3333 349.667 27.8856 349.667 27.3333V25.3333C349.667 24.781 349.219 24.3333 348.667 24.3333Z"
              fill="black"
            />
            <path
              d="M37.3208 28.2563C40.0088 28.2563 41.6055 26.1543 41.6055 22.5947C41.6055 21.2544 41.3491 20.1265 40.8584 19.2549C40.1479 17.8999 38.9248 17.1675 37.3794 17.1675C35.0796 17.1675 33.4536 18.7129 33.4536 20.8809C33.4536 22.917 34.9185 24.3965 36.9326 24.3965C38.1704 24.3965 39.1738 23.8179 39.6719 22.8145H39.6938C39.6938 22.8145 39.7231 22.8145 39.7305 22.8145C39.7451 22.8145 39.7964 22.8145 39.7964 22.8145C39.7964 25.2314 38.8809 26.6743 37.3354 26.6743C36.4272 26.6743 35.7241 26.1763 35.4824 25.3779H33.6001C33.915 27.1138 35.3872 28.2563 37.3208 28.2563ZM37.3867 22.895C36.1709 22.895 35.3066 22.0308 35.3066 20.8223C35.3066 19.6431 36.2148 18.7422 37.394 18.7422C38.5732 18.7422 39.4814 19.6577 39.4814 20.8516C39.4814 22.0308 38.5952 22.895 37.3867 22.895Z"
              fill="black"
            />
            <path
              d="M44.6966 28.1538C45.3924 28.1538 45.8685 27.6558 45.8685 26.9966C45.8685 26.3301 45.3924 25.8394 44.6966 25.8394C44.0081 25.8394 43.5247 26.3301 43.5247 26.9966C43.5247 27.6558 44.0081 28.1538 44.6966 28.1538ZM44.6966 22.6606C45.3924 22.6606 45.8685 22.1699 45.8685 21.5107C45.8685 20.8442 45.3924 20.3535 44.6966 20.3535C44.0081 20.3535 43.5247 20.8442 43.5247 21.5107C43.5247 22.1699 44.0081 22.6606 44.6966 22.6606Z"
              fill="black"
            />
            <path
              d="M52.7242 28H54.5333V26.0298H55.9615V24.4331H54.5333V17.4312H51.8673C49.9996 20.2437 48.5128 22.5947 47.5606 24.3452V26.0298H52.7242V28ZM49.3111 24.3672C50.5416 22.1992 51.6402 20.4634 52.651 18.9692H52.7535V24.4771H49.3111V24.3672Z"
              fill="black"
            />
            <path
              d="M59.9901 28H61.8798V17.4312H59.9975L57.2362 19.3647V21.1812L59.8656 19.3354H59.9901V28Z"
              fill="black"
            />
            <rect
              x="147"
              y="913"
              width="134"
              height="5"
              rx="2.5"
              fill="#3E3E3E"
            />
          </g>
          <defs>
            <filter
              id="filter0_d_68_660"
              x="0"
              y="877.6"
              width="428"
              height="50.4"
              filterUnits="userSpaceOnUse"
              color-interpolation-filters="sRGB"
            >
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feColorMatrix
                in="SourceAlpha"
                type="matrix"
                values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
                result="hardAlpha"
              />
              <feOffset dy="-0.4" />
              <feColorMatrix
                type="matrix"
                values="0 0 0 0 0.756863 0 0 0 0 0.756863 0 0 0 0 0.756863 0 0 0 1 0"
              />
              <feBlend
                mode="normal"
                in2="BackgroundImageFix"
                result="effect1_dropShadow_68_660"
              />
              <feBlend
                mode="normal"
                in="SourceGraphic"
                in2="effect1_dropShadow_68_660"
                result="shape"
              />
            </filter>
            <clipPath id="clip0_68_660">
              <rect width="428" height="926" fill="white" />
            </clipPath>
          </defs>
        </svg>

        <div
          className="absolute overflow-hidden"
          style={{
            top: statusBarHeight,
            left: 0,
            right: 0,
            bottom: bottomBarHeight,
            overflow: 'hidden',
          }}
        >
          {children}
        </div>
      </div>
    </div>
  )
})
